"use strict";(self.webpackChunkkubeflow_frontend=self.webpackChunkkubeflow_frontend||[]).push([[778],{56304:function(e,t,n){n.d(t,{Zy:function(){return r},iu:function(){return l},rA:function(){return s},wN:function(){return c}});var a=n(61143),i="http://fetian.gateway.tme.woa.com",r=function(e){return a.Z.get("/api/v1/getDatabasesOverview",{params:e,baseURL:"http://musichouse.data.tme.woa.com"})},l=function(e){return a.Z.get("/api/swallow/lifecycle/offline/set",{params:e})},s=function(e){return a.Z.get("/getExecutingTasks",{params:{taskStatusKey:e},baseURL:i})},c=function(e){return a.Z.get("/kill",{params:{task_id:e},baseURL:i})}},5866:function(e,t,n){var a=n(29439),i=n(4519),r=n(88977),l=n(81190),s=n(93849),c=n(2556);t.Z=function(e){var t=r.Z.useForm(),n=(0,a.Z)(t,1)[0],o=(0,i.useState)(),d=(0,a.Z)(o,2)[1];i.useCallback((function(){return d({})}),[]);(0,i.useEffect)((function(){e.formData&&n.setFieldsValue(e.formData)}),[e]);var u=(0,i.useState)({currentChange:{},allValues:{}}),h=(0,a.Z)(u,2),f=h[0],m=h[1];return(0,c.jsx)(l.Z,{destroyOnClose:!0,maskClosable:!1,width:e.width||680,visible:e.visible,title:e.title,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onCancel:function(){n.resetFields(),e.onCancel()},onOk:function(){console.log(n.getFieldsValue()),n.validateFields().then((function(t){e.onCreate(t)})).catch((function(e){}))},children:(0,c.jsx)(s.Z,{spinning:e.loading,children:(0,c.jsx)(r.Z,{onValuesChange:function(e,t){m({currentChange:e,allValues:t})},labelCol:{span:5},wrapperCol:{span:19},form:n,layout:"horizontal",name:"form_in_modal",children:e.children&&"[object Function]"===Object.prototype.toString.call(e.children)?e.children(n,f):e.children})})})}},92306:function(e,t,n){n.d(t,{Z:function(){return S}});var a=n(93433),i=n(29439),r=n(1413),l=n(44925),s=n(4519),c=n(35492),o=n(20011),d=n(81190),u=n(28532),h=n(12513),f=n(90575),m=n(10089),x=n(2704),j=n(25738),p=n(66724),Z=n(602),g=n(24520),v=n.n(g),b=n(74308),y=n(2556),w=["onResize","width"],T=n(17972),N=function(){return(0,y.jsxs)(c.Z,{justify:"center",align:"middle",style:{height:360,flexDirection:"column"},children:[(0,y.jsx)("img",{src:Z,style:{width:266},alt:""}),(0,y.jsx)("div",{children:"\u6682\u65e0\u6570\u636e"})]})},k=function(e){var t=e.onResize,n=e.width,a=(0,l.Z)(e,w);return n?(0,y.jsx)(b.Resizable,{width:n,height:0,handle:(0,y.jsx)("span",{className:"react-resizable-handle",onClick:function(e){e.stopPropagation()}}),onResize:t,draggableOpts:{enableUserSelectHack:!1},children:(0,y.jsx)("th",(0,r.Z)((0,r.Z)({},a),{},{style:(0,r.Z)((0,r.Z)({},null===a||void 0===a?void 0:a.style),{},{userSelect:"none"})}))}):(0,y.jsx)("th",(0,r.Z)({},a))},S=function(e){var t=(0,s.useState)(!1),n=(0,i.Z)(t,2),l=n[0],Z=n[1],g=(0,s.useState)({header:[],data:[]}),b=(0,i.Z)(g,2),w=b[0],S=b[1],C=(0,s.useState)([]),I=(0,i.Z)(C,2),z=I[0],E=I[1],L=(0,s.useState)(e.columns),P=(0,i.Z)(L,2),R=P[0],O=P[1],F=function(t){return function(n,i){var l=i.size;if(!(l.width<100)){var s=(0,a.Z)(R);s[t]=(0,r.Z)((0,r.Z)({},s[t]),{},{width:l.width});var c=s.reduce((function(e,t){return e+t.width||100}),0)+200;localStorage.setItem(e.tableKey||"",JSON.stringify(s)),V((0,r.Z)((0,r.Z)({},K),{},{x:c})),O(s)}}},D=R.map((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},{width:e.width||200,onHeaderCell:function(e){return{width:e.width,onResize:F(t)}}})})),H=(0,s.useState)(e.scroll),_=(0,i.Z)(H,2),K=_[0],V=_[1];(0,s.useEffect)((function(){O(e.columns)}),[e.columns]),(0,s.useEffect)((function(){V(e.scroll)}),[e.scroll]),(0,s.useEffect)((function(){if(e.dataSource){var t=e.columns.filter((function(e){return~z.indexOf(e.dataIndex)}));W(t,e.dataSource)}}),[e.dataSource,e.columns]);var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.map((function(e){return e.dataIndex})).filter((function(e){return"handle"!==e})),a=e.map((function(e){return e.title})).filter((function(e){return"\u64cd\u4f5c"!==e})),i=[];t.forEach((function(e){var t={};n.map((function(n){var a=e[n];t[n]=a||""})),i.push(t)})),S({header:a,data:i})},B=function(){var e=w.header,t=w.data,n="";return e.length&&t.length?(n="|"+e.join("|")+"|\n",t.forEach((function(e){var t=Object.values(e).map((function(e){return""===e?" ":e}));n=n+"|"+t.join("|")+"|\n"}))):n="",n},U=function(){var e=w.header,t=w.data,n="";return e.length&&t.length?(n=e.join("\t")+"\n",t.forEach((function(e){var t=Object.values(e).map((function(e){return""===e?" ":e}));n=n+t.join("\t")+"\n"}))):n="",n};return(0,y.jsxs)(o.Z,{className:"tablebox",direction:"vertical",size:"middle",children:[(0,y.jsxs)(d.Z,{width:1e3,maskClosable:!1,centered:!0,bodyStyle:{maxHeight:500,overflow:"auto"},visible:l,title:"\u5bfc\u51fa\u6570\u636e",onCancel:function(){Z(!1)},footer:null,children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsxs)("div",{className:"mb16",children:[(0,y.jsx)("span",{className:"pr8",children:"\u9009\u62e9\u9700\u8981\u5bfc\u51fa\u7684\u5217\uff1a"}),(0,y.jsx)(u.Z.Group,{options:e.columns.map((function(e){return{label:e.title,value:e.dataIndex}})).filter((function(e){return"handle"!==e.value})),defaultValue:[],value:z,onChange:function(t){E(t);var n=e.columns.filter((function(e){return~t.indexOf(e.dataIndex)}));W(n,e.dataSource)}})]}),(0,y.jsxs)("div",{style:{position:"absolute",right:0,bottom:0},children:[(0,y.jsx)(h.Z,{size:"small",type:"link",onClick:function(){E(e.columns.map((function(e){return e.dataIndex})).filter((function(e){return"handle"!==e}))),W(e.columns,e.dataSource)},children:"\u5168\u9009"}),(0,y.jsx)(h.Z,{size:"small",type:"link",onClick:function(){E([]),W([],e.dataSource)},children:"\u53cd\u9009"})]})]}),(0,y.jsxs)(f.Z,{children:[(0,y.jsx)(f.Z.TabPane,{tab:"Wiki\u683c\u5f0f",children:(0,y.jsx)(T,{text:B(),onCopy:function(){return m.ZP.success("\u5df2\u590d\u5236\u5230\u7c98\u8d34\u677f")},children:(0,y.jsx)("pre",{style:{cursor:"pointer",minHeight:100},children:(0,y.jsx)("code",{children:B()})})})},"jira"),(0,y.jsx)(f.Z.TabPane,{tab:"Text\u683c\u5f0f",children:(0,y.jsx)(T,{text:U(),onCopy:function(){return m.ZP.success("\u5df2\u590d\u5236\u5230\u7c98\u8d34\u677f")},children:(0,y.jsx)("pre",{style:{cursor:"pointer",minHeight:100},children:(0,y.jsx)("code",{children:U()})})})},"test"),(0,y.jsx)(f.Z.TabPane,{tab:"Excel\u683c\u5f0f",children:(0,y.jsx)(c.Z,{justify:"center",align:"middle",style:{minHeight:100},children:(0,y.jsx)(x.Z,{children:(0,y.jsx)(h.Z,{type:"primary",onClick:function(){var e={fileName:"result"};e.datas=[{sheetData:w.data,sheetName:"sheet",sheetHeader:w.header}],new(v())(e).saveExcel()},children:"\u5bfc\u51faExcel"})})})},"excel")]})]}),e.titleNode||e.buttonNode||!e.cancelExportData?(0,y.jsxs)(c.Z,{justify:"space-between",align:"middle",children:[(0,y.jsx)(x.Z,{children:(0,y.jsx)(o.Z,{align:"center",children:e.titleNode})}),(0,y.jsx)(x.Z,{children:(0,y.jsxs)(o.Z,{align:"center",children:[e.buttonNode,e.cancelExportData?null:(0,y.jsx)(h.Z,{style:{marginLeft:6},onClick:function(){return Z(!0)},children:"\u5bfc\u51fa\u6570\u636e"})]})})]}):null,(0,y.jsx)(j.ZP,{renderEmpty:N,children:(0,y.jsx)(p.Z,{size:e.size||"middle",rowKey:e.rowKey?e.rowKey:"id",dataSource:e.dataSource,components:{header:{cell:k}},columns:D,pagination:!1!==e.pagination&&(0,r.Z)({},e.pagination),scroll:K,loading:e.loading,onChange:e.onChange,rowSelection:e.rowSelection})})]})}},76722:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(1413),i=(n(4519),n(64252)),r=n(35492),l=n(2704),s=n(20011),c=n(2556),o=i.Z.Title,d=function(e){var t={position:"sticky",top:0};return(0,c.jsxs)(r.Z,{className:"title-header",justify:"space-between",align:"middle",style:e.noBorderBottom?(0,a.Z)({borderBottom:"none"},t):t,children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(o,{className:"d-il mr12",level:5,style:{marginBottom:10},children:e.title}),(0,c.jsx)("div",{className:"d-il",children:e.breadcrumbs})]}),(0,c.jsx)(l.Z,{children:(0,c.jsx)(s.Z,{children:e.children?e.children:null})})]})}},83778:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var a=n(29439),i=n(4519),r=n(10089),l=n(88977),s=n(10050),c=n(10007),o=n(12513),d=n(41663),u=n(34745),h=n(2704),f=n(72625),m=n(20011),x=n(20112),j=n(37167),p=n(76722),Z=n(92306),g=n(35192),v=n(70332),b=n(5866),y=n(60685),w=n(56304),T=n(16548),N=n(2556),k=["shenyuanli","zeluswu","jiamingmai","martinpchen","samcchen","flytengzeng","xuxuqin","admin"].includes(y.Z.get("myapp_username")||"");function S(){(0,v.s0)();var e=(0,i.useState)([]),t=(0,a.Z)(e,2),n=t[0],S=t[1],C=(0,i.useState)(!1),I=(0,a.Z)(C,2),z=I[0],E=I[1],L=(0,i.useState)(!1),P=(0,a.Z)(L,2),R=P[0],O=P[1],F=(0,i.useState)(!1),D=(0,a.Z)(F,2),H=D[0],_=D[1],K=(0,i.useState)((0,T.jS)("database")),V=(0,a.Z)(K,2),W=V[0],B=V[1],U=(0,i.useState)((0,T.jS)("table")),A=(0,a.Z)(U,2),q=A[0],G=A[1],J=(0,i.useState)(y.Z.get("myapp_username")||void 0),M=(0,a.Z)(J,2),Y=M[0],Q=M[1],X=(0,i.useState)(),$=(0,a.Z)(X,2),ee=$[0],te=$[1];(0,i.useEffect)((function(){ne()}),[]);var ne=function(){E(!0),(0,w.Zy)({database:W||void 0,table:q||void 0,owner:Y||void 0}).then((function(e){S(e.data)})).finally((function(){return E(!1)}))};return(0,N.jsxs)("div",{children:[(0,N.jsxs)(b.Z,{title:"\u4fee\u6539TTL",loading:R,visible:H,formData:{lifecycle:null===ee||void 0===ee?void 0:ee.ttl},onCancel:function(){_(!1)},onCreate:function(e){O(!0);var t=e.lifecycle;ee&&(0,w.iu)({swallowTaskId:ee.swallowTaskId,db:ee.database,tb:ee.table,lifecycle:t}).then((function(e){e.data.success?(r.ZP.success("\u4fee\u6539TTL\u6210\u529f"),ne(),_(!1)):r.ZP.error(e.data.errorMessage)})).catch((function(e){r.ZP.error("\u4fee\u6539TTL\u5931\u8d25")})).finally((function(){O(!1)}))},children:[(0,N.jsx)(l.Z.Item,{label:"\u8868\u540d\u79f0",children:(0,N.jsx)("span",{children:null===ee||void 0===ee?void 0:ee.table})}),(0,N.jsx)(l.Z.Item,{label:"\u63a8\u8350TTL",children:(0,N.jsx)("span",{children:null===ee||void 0===ee?void 0:ee.recommendedTtl})}),(0,N.jsx)(l.Z.Item,{label:"TTL",name:"lifecycle",rules:[{required:!0,message:"\u8bf7\u8f93\u5165TTL"}],children:(0,N.jsx)(s.Z,{style:{width:300}})})]}),(0,N.jsx)(p.Z,{title:"\u8868TTL\u7ba1\u7406"}),(0,N.jsxs)("div",{className:"d-f pt24 plr24",children:[(0,N.jsxs)("div",{className:"mr16 d-f ac",children:[(0,N.jsx)("span",{className:"ta-l s0",style:{width:120},children:"\u6570\u636e\u5e93\u540d\u79f0\uff1a"}),(0,N.jsx)(c.Z,{onPressEnter:function(){ne()},placeholder:"\u6570\u636e\u5e93\u540d\u79f0",style:{width:256},value:W,onChange:function(e){return B(e.target.value)}})]}),(0,N.jsxs)("div",{className:"mr16 d-f ac",children:[(0,N.jsx)("span",{className:"ta-r s0",style:{width:80},children:"\u8868\u540d\u79f0\uff1a"}),(0,N.jsx)(c.Z,{onPressEnter:function(){ne()},placeholder:"\u8868\u540d\u79f0",style:{width:256},value:q,onChange:function(e){return G(e.target.value)}})]}),k?(0,N.jsxs)("div",{className:"mr16 d-f ac",children:[(0,N.jsx)("span",{className:"ta-r s0",style:{width:80},children:"\u8d1f\u8d23\u4eba\uff1a"}),(0,N.jsx)(c.Z,{onPressEnter:function(){ne()},placeholder:"\u8d1f\u8d23\u4eba/\u82f1\u6587\u540d",style:{width:256},value:Y,onChange:function(e){return Q(e.target.value)}})]}):null,(0,N.jsx)(o.Z,{type:"primary",onClick:function(){ne()},children:"\u641c\u7d22"})]}),(0,N.jsx)(j.VY,{className:"appmgmt-content",children:(0,N.jsx)("div",{className:"p24",children:(0,N.jsx)(d.Z,{loading:z,active:!0,style:{minHeight:500},children:n.length?(0,N.jsx)(u.Z,{bordered:!1,defaultActiveKey:["database0"],expandIcon:function(e){var t=e.isActive;return(0,N.jsx)(g.Z,{rotate:t?90:0})},className:"site-collapse-custom-collapse",children:n.map((function(e,t){return(0,N.jsx)(u.Z.Panel,{header:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("span",{className:"mr16",children:["\u6570\u636e\u5e93\u540d\u79f0\uff1a",(0,N.jsx)("span",{className:"link",children:e.databaseName})]}),(0,N.jsxs)("span",{className:"mr16",children:["\u8868\u6570\u76ee\uff1a",(0,N.jsx)("span",{children:e.tables.length})]})]}),className:"site-collapse-custom-panel",children:(0,N.jsx)(Z.Z,{titleNode:(0,N.jsx)(h.Z,{className:"tablebox-title",children:"\u4efb\u52a1\u5217\u8868"}),rowKey:function(e){return"".concat(e.table,"_").concat(t)},columns:[{title:"\u8868\u540d",dataIndex:"table",key:"table",width:300,fixed:"left",render:function(e,t){return(0,N.jsx)("div",{children:(0,N.jsx)("div",{className:"c-theme",children:t.table})})}},{title:"TTL",dataIndex:"ttl",key:"ttl",width:100,align:"right",sorter:function(e,t){return e.ttl-t.ttl},render:function(e,t){return-999===t.ttl?"-":(0,N.jsx)("span",{className:[t.ttl>t.recommendedTtl?"c-fail":"c-success"].join(" "),children:t.ttl})}},{title:"\u63a8\u8350TTL",dataIndex:"recommendedTtl",key:"recommendedTtl",width:120,align:"right",sorter:function(e,t){return e.recommendedTtl-t.recommendedTtl},render:function(e,t){return-999===t.recommendedTtl?"-":(0,N.jsx)("span",{className:"c-theme",children:t.recommendedTtl})}},{title:"\u6210\u672c",dataIndex:"cost",key:"cost",width:150,align:"right",sorter:function(e,t){return e.cost-t.cost},render:function(e,t){return(0,N.jsxs)(f.Z,{color:"warning",children:[(+t.cost||0).toFixed(2)," \xa5"]})}},{title:"\u6309\u63a8\u8350\u53ef\u8282\u7701",dataIndex:"savedCostWithRecommendedTtl",key:"savedCostWithRecommendedTtl",width:150,align:"right",sorter:function(e,t){return e.savedCostWithRecommendedTtl-t.savedCostWithRecommendedTtl},render:function(e,t){return(0,N.jsxs)(f.Z,{color:"blue",children:[(+t.savedCostWithRecommendedTtl||0).toFixed(2)," \xa5"]})}},{title:"\u7c7b\u578b",dataIndex:"tableSourceType",key:"tableSourceType",width:100},{title:"\u8868\u5927\u5c0f",dataIndex:"formattedSize",key:"formattedSize",width:150,align:"right",sorter:function(e,t){return e.size-t.size}},{title:"\u5206\u533a\u4e2a\u6570",dataIndex:"cycleNumber",key:"cycleNumber",width:120,align:"right",sorter:function(e,t){return e.cycleNumber-t.cycleNumber},render:function(e,t){return t.cycleNumber||"-"}},{title:"\u8d1f\u8d23\u4eba",dataIndex:"owner",key:"owner",width:100,render:function(e,t){return t.owner||"-"}},{title:"\u64cd\u4f5c",width:100,dataIndex:"handle",key:"handle",align:"right",fixed:"right",render:function(e,t){return(0,N.jsx)(m.Z,{size:"middle",children:(0,N.jsx)("span",{className:"link",onClick:function(){_(!0),te(t)},children:"\u4fee\u6539TTL"})})}}],loading:z,pagination:!1,dataSource:e.tables.sort((function(e,t){return t.cost-e.cost})),scroll:{x:1200,y:400}})},"database".concat(t))}))}):(0,N.jsx)("div",{className:"bor b-side",children:(0,N.jsx)(x.Z,{className:"mtb64"})})})})})]})}},602:function(e,t,n){e.exports=n.p+"static/media/emptyBg.15fdf5f39309784ac66e.png"}}]);
//# sourceMappingURL=778.05485bf7.chunk.js.map