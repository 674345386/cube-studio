"use strict";(self.webpackChunkkubeflow_frontend=self.webpackChunkkubeflow_frontend||[]).push([[81],{5866:function(e,n,t){var a=t(29439),r=t(4519),i=t(88977),c=t(81190),o=t(93849),l=t(2556);n.Z=function(e){var n=i.Z.useForm(),t=(0,a.Z)(n,1)[0],s=(0,r.useState)(),u=(0,a.Z)(s,2)[1];r.useCallback((function(){return u({})}),[]);(0,r.useEffect)((function(){e.formData&&t.setFieldsValue(e.formData)}),[e]);var d=(0,r.useState)({currentChange:{},allValues:{}}),f=(0,a.Z)(d,2),m=f[0],h=f[1];return(0,l.jsx)(c.Z,{destroyOnClose:!0,maskClosable:!1,width:e.width||680,visible:e.visible,title:e.title,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onCancel:function(){t.resetFields(),e.onCancel()},onOk:function(){console.log(t.getFieldsValue()),t.validateFields().then((function(n){e.onCreate(n)})).catch((function(e){}))},children:(0,l.jsx)(o.Z,{spinning:e.loading,children:(0,l.jsx)(i.Z,{onValuesChange:function(e,n){h({currentChange:e,allValues:n})},labelCol:{span:5},wrapperCol:{span:19},form:t,layout:"horizontal",name:"form_in_modal",children:e.children&&"[object Function]"===Object.prototype.toString.call(e.children)?e.children(t,m):e.children})})})}},92306:function(e,n,t){t.d(n,{Z:function(){return C}});var a=t(93433),r=t(29439),i=t(1413),c=t(44925),o=t(4519),l=t(35492),s=t(20011),u=t(81190),d=t(28532),f=t(12513),m=t(90575),h=t(10089),p=t(2704),Z=t(25738),v=t(66724),x=t(602),j=t(24520),g=t.n(j),y=t(74308),b=t(2556),S=["onResize","width"],k=t(17972),_=function(){return(0,b.jsxs)(l.Z,{justify:"center",align:"middle",style:{height:360,flexDirection:"column"},children:[(0,b.jsx)("img",{src:x,style:{width:266},alt:""}),(0,b.jsx)("div",{children:"\u6682\u65e0\u6570\u636e"})]})},w=function(e){var n=e.onResize,t=e.width,a=(0,c.Z)(e,S);return t?(0,b.jsx)(y.Resizable,{width:t,height:0,handle:(0,b.jsx)("span",{className:"react-resizable-handle",onClick:function(e){e.stopPropagation()}}),onResize:n,draggableOpts:{enableUserSelectHack:!1},children:(0,b.jsx)("th",(0,i.Z)((0,i.Z)({},a),{},{style:(0,i.Z)((0,i.Z)({},null===a||void 0===a?void 0:a.style),{},{userSelect:"none"})}))}):(0,b.jsx)("th",(0,i.Z)({},a))},C=function(e){var n=(0,o.useState)(!1),t=(0,r.Z)(n,2),c=t[0],x=t[1],j=(0,o.useState)({header:[],data:[]}),y=(0,r.Z)(j,2),S=y[0],C=y[1],N=(0,o.useState)([]),O=(0,r.Z)(N,2),I=O[0],P=O[1],T=(0,o.useState)(e.columns),E=(0,r.Z)(T,2),M=E[0],z=E[1],H=function(n){return function(t,r){var c=r.size;if(!(c.width<100)){var o=(0,a.Z)(M);o[n]=(0,i.Z)((0,i.Z)({},o[n]),{},{width:c.width});var l=o.reduce((function(e,n){return e+n.width||100}),0)+200;localStorage.setItem(e.tableKey||"",JSON.stringify(o)),L((0,i.Z)((0,i.Z)({},D),{},{x:l})),z(o)}}},F=M.map((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},{width:e.width||200,onHeaderCell:function(e){return{width:e.width,onResize:H(n)}}})})),R=(0,o.useState)(e.scroll),V=(0,r.Z)(R,2),D=V[0],L=V[1];(0,o.useEffect)((function(){z(e.columns)}),[e.columns]),(0,o.useEffect)((function(){L(e.scroll)}),[e.scroll]),(0,o.useEffect)((function(){if(e.dataSource){var n=e.columns.filter((function(e){return~I.indexOf(e.dataIndex)}));J(n,e.dataSource)}}),[e.dataSource,e.columns]);var J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,t=e.map((function(e){return e.dataIndex})).filter((function(e){return"handle"!==e})),a=e.map((function(e){return e.title})).filter((function(e){return"\u64cd\u4f5c"!==e})),r=[];n.forEach((function(e){var n={};t.map((function(t){var a=e[t];n[t]=a||""})),r.push(n)})),C({header:a,data:r})},K=function(){var e=S.header,n=S.data,t="";return e.length&&n.length?(t="|"+e.join("|")+"|\n",n.forEach((function(e){var n=Object.values(e).map((function(e){return""===e?" ":e}));t=t+"|"+n.join("|")+"|\n"}))):t="",t},Y=function(){var e=S.header,n=S.data,t="";return e.length&&n.length?(t=e.join("\t")+"\n",n.forEach((function(e){var n=Object.values(e).map((function(e){return""===e?" ":e}));t=t+n.join("\t")+"\n"}))):t="",t};return(0,b.jsxs)(s.Z,{className:"tablebox",direction:"vertical",size:"middle",children:[(0,b.jsxs)(u.Z,{width:1e3,maskClosable:!1,centered:!0,bodyStyle:{maxHeight:500,overflow:"auto"},visible:c,title:"\u5bfc\u51fa\u6570\u636e",onCancel:function(){x(!1)},footer:null,children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsxs)("div",{className:"mb16",children:[(0,b.jsx)("span",{className:"pr8",children:"\u9009\u62e9\u9700\u8981\u5bfc\u51fa\u7684\u5217\uff1a"}),(0,b.jsx)(d.Z.Group,{options:e.columns.map((function(e){return{label:e.title,value:e.dataIndex}})).filter((function(e){return"handle"!==e.value})),defaultValue:[],value:I,onChange:function(n){P(n);var t=e.columns.filter((function(e){return~n.indexOf(e.dataIndex)}));J(t,e.dataSource)}})]}),(0,b.jsxs)("div",{style:{position:"absolute",right:0,bottom:0},children:[(0,b.jsx)(f.Z,{size:"small",type:"link",onClick:function(){P(e.columns.map((function(e){return e.dataIndex})).filter((function(e){return"handle"!==e}))),J(e.columns,e.dataSource)},children:"\u5168\u9009"}),(0,b.jsx)(f.Z,{size:"small",type:"link",onClick:function(){P([]),J([],e.dataSource)},children:"\u53cd\u9009"})]})]}),(0,b.jsxs)(m.Z,{children:[(0,b.jsx)(m.Z.TabPane,{tab:"Wiki\u683c\u5f0f",children:(0,b.jsx)(k,{text:K(),onCopy:function(){return h.ZP.success("\u5df2\u590d\u5236\u5230\u7c98\u8d34\u677f")},children:(0,b.jsx)("pre",{style:{cursor:"pointer",minHeight:100},children:(0,b.jsx)("code",{children:K()})})})},"jira"),(0,b.jsx)(m.Z.TabPane,{tab:"Text\u683c\u5f0f",children:(0,b.jsx)(k,{text:Y(),onCopy:function(){return h.ZP.success("\u5df2\u590d\u5236\u5230\u7c98\u8d34\u677f")},children:(0,b.jsx)("pre",{style:{cursor:"pointer",minHeight:100},children:(0,b.jsx)("code",{children:Y()})})})},"test"),(0,b.jsx)(m.Z.TabPane,{tab:"Excel\u683c\u5f0f",children:(0,b.jsx)(l.Z,{justify:"center",align:"middle",style:{minHeight:100},children:(0,b.jsx)(p.Z,{children:(0,b.jsx)(f.Z,{type:"primary",onClick:function(){var e={fileName:"result"};e.datas=[{sheetData:S.data,sheetName:"sheet",sheetHeader:S.header}],new(g())(e).saveExcel()},children:"\u5bfc\u51faExcel"})})})},"excel")]})]}),e.titleNode||e.buttonNode||!e.cancelExportData?(0,b.jsxs)(l.Z,{justify:"space-between",align:"middle",children:[(0,b.jsx)(p.Z,{children:(0,b.jsx)(s.Z,{align:"center",children:e.titleNode})}),(0,b.jsx)(p.Z,{children:(0,b.jsxs)(s.Z,{align:"center",children:[e.buttonNode,e.cancelExportData?null:(0,b.jsx)(f.Z,{style:{marginLeft:6},onClick:function(){return x(!0)},children:"\u5bfc\u51fa\u6570\u636e"})]})})]}):null,(0,b.jsx)(Z.ZP,{renderEmpty:_,children:(0,b.jsx)(v.Z,{size:e.size||"middle",rowKey:e.rowKey?e.rowKey:"id",dataSource:e.dataSource,components:{header:{cell:w}},columns:F,pagination:!1!==e.pagination&&(0,i.Z)({},e.pagination),scroll:D,loading:e.loading,onChange:e.onChange,rowSelection:e.rowSelection})})]})}},76722:function(e,n,t){t.d(n,{Z:function(){return u}});var a=t(1413),r=(t(4519),t(64252)),i=t(35492),c=t(2704),o=t(20011),l=t(2556),s=r.Z.Title,u=function(e){var n={position:"sticky",top:0};return(0,l.jsxs)(i.Z,{className:"title-header",justify:"space-between",align:"middle",style:e.noBorderBottom?(0,a.Z)({borderBottom:"none"},n):n,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(s,{className:"d-il mr12",level:5,style:{marginBottom:10},children:e.title}),(0,l.jsx)("div",{className:"d-il",children:e.breadcrumbs})]}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.Z,{children:e.children?e.children:null})})]})}},13081:function(e,n,t){t.r(n),t.d(n,{default:function(){return G}});var a=t(93433),r=t(4942),i=t(1413),c=t(29439),o=t(4519),l=t(76245),s=t(20011),u=t(42496),d=t(82574),f=t(10089),m=t(81190),h=t(52077),p=t(1449),Z=t(16609),v=t(93849),x=t(35492),j=t(2704),g=t(12513),y=t(37167),b=t(76722),S=t(92306),k=t(43077),_=t.n(k),w=t(33405),C=t(17669),N=t(33531),O=t(56713),I=t(20558),P=t(8718),T=t(70332),E=t(16548),M=t(5866),z=t(30506),H=t(15861),F=t(87757),R=t.n(F),V=t(47474),D=t(88977),L=t(10007),J=t(28501),K=t(74030),Y=t(2556),q=V.Z.Option,B=function(e){var n=D.Z.useForm(),t=(0,c.Z)(n,1)[0],r=(0,o.useState)(!1),l=(0,c.Z)(r,2),s=l[0],u=l[1],d=(0,o.useState)([]),f=(0,c.Z)(d,2),m=(f[0],f[1],function(e){return(e||[]).map((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},{indexKey:n})}))}),h=(0,o.useState)(m(e.params)),p=(0,c.Z)(h,2),Z=p[0],v=p[1],y=(0,o.useState)(m(e.params)),b=(0,c.Z)(y,2),S=b[0],k=b[1],_=(0,o.useState)(new Map),w=(0,c.Z)(_,2),N=w[0],O=w[1];(0,o.useEffect)((function(){if(e.values){var n=e.values.length?e.values:[{key:void 0,value:void 0}];t.setFieldsValue({group:n});for(var r=(0,a.Z)(S),i=0;i<r.length;i++)for(var c=0;c<n.length;c++){void 0!==n[c]&&n[c].key===r[i].name&&(r[i].used=!0)}k(r)}}),[e.values]),(0,o.useEffect)((function(){if(e.params&&e.params.length){var n=m(e.params);v(n);for(var t=N,a=0;a<n.length;a++){var r=n[a];t.set(r.name,r)}O(t)}}),[e.params]);var P=function(){var n=(0,H.Z)(R().mark((function n(t){var a,r;return R().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log(t),a=t.group.filter((function(e){return!!e.key})),r=a.map((function(e){return{key:e.key,value:e.value}})),e.onChange(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),T=function(e){var n=t.getFieldValue(["group",e,"key"]);if(!n)return(0,Y.jsx)(L.Z,{style:{width:"65%"},onPressEnter:function(){return E()}});var a=N.get(n);if("input"===(null===a||void 0===a?void 0:a.type))return(0,Y.jsx)(L.Z,{style:{width:"65%"},defaultValue:a.defalutValue,placeholder:a.placeHolder,onPressEnter:function(){return E()}});if("select"===(null===a||void 0===a?void 0:a.type)){var r=(null===a||void 0===a?void 0:a.option)||[];return(0,Y.jsx)(V.Z,{style:{width:"65%"},dropdownMatchSelectWidth:500,showSearch:!0,mode:"label"===n?"multiple":void 0,optionFilterProp:"label",options:r.map((function(e){return{label:e.label,value:e.value}}))})}},E=function(){t.validateFields()};return(0,Y.jsxs)(D.Z,{className:"cmdb-mixsearch bg-title",form:t,onFinish:P,initialValues:{group:[{key:void 0,value:void 0}]},children:[(0,Y.jsxs)(x.Z,{className:"cmdb-mixsearch-content",gutter:16,style:(0,i.Z)({marginLeft:0,marginRight:0},s?{height:70}:{height:"auto"}),children:[(0,Y.jsx)(D.Z.List,{name:"group",children:function(e,n){var r=n.add,i=n.remove;return(0,Y.jsxs)(Y.Fragment,{children:[e.map((function(e,n){return(0,Y.jsx)(j.Z,{span:8,children:(0,Y.jsxs)(x.Z,{align:"middle",gutter:8,children:[(0,Y.jsx)(j.Z,{className:"cmdb-mixsearch-group",children:(0,Y.jsxs)(L.Z.Group,{compact:!0,children:[(0,Y.jsx)(D.Z.Item,{noStyle:!0,name:[e.name,"key"],rules:[{required:!1,message:"\u8bf7\u9009\u62e9key"}],children:(0,Y.jsx)(V.Z,{style:{width:"35%"},placeholder:"\u8bf7\u9009\u62e9",onChange:function(e){!function(e){for(var n=(0,a.Z)(S),r=(t.getFieldValue("group")||[]).filter((function(e){return!!e})).map((function(e){return e.key})),i=0;i<n.length;i++){var c=n[i];c.name===e?n[i].used=!0:r.includes(c.name)||(n[i].used=!1)}k(n)}(e)},children:S.map((function(e,n){return(0,Y.jsx)(q,{style:{display:e.used?"none":"inherit"},value:e.name,children:e.title||e.name},"mixSearch_".concat(e.name,"_").concat(n))}))})}),(0,Y.jsx)(D.Z.Item,{noStyle:!0,shouldUpdate:!0,name:[e.name,"value"],rules:[{required:!1,message:"\u8bf7\u586b\u5199value"}],children:T(n)})]})}),(0,Y.jsx)(j.Z,{className:"cmdb-mixsearch-delete",onClick:function(){var e=(t.getFieldValue("group")||[]).map((function(e){return e?e.key:void 0})),r=(0,a.Z)(S);if(e[n])for(var c=0;c<r.length;c++){r[c].name===e[n]&&(r[c].used=!1)}k(r),i(n)},children:(0,Y.jsx)(J.Z,{})})]})},"mixSearch_".concat(e.key,"_").concat(n))})),Z.length!==e.length&&(0,Y.jsx)(j.Z,{className:"cmdb-mixsearch-add d-il",onClick:function(){r()},children:(0,Y.jsx)(I.Z,{})})]})}}),(0,Y.jsx)(j.Z,{flex:1,children:(0,Y.jsx)(x.Z,{justify:"end",children:(0,Y.jsx)(g.Z,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"})})})]}),(0,Y.jsx)(x.Z,{className:"cmdb-mixsearch-collapsed",children:(0,Y.jsx)(x.Z,{onClick:function(){u(!s)},justify:"center",align:"middle",children:s?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(j.Z,{children:"\u5c55\u5f00"}),(0,Y.jsx)(j.Z,{children:(0,Y.jsx)(C.Z,{})})]}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(j.Z,{children:"\u6536\u8d77"}),(0,Y.jsx)(j.Z,{children:(0,Y.jsx)(K.Z,{})})]})})})]})},A=t(72756);function G(e){var n=(0,T.s0)(),t=(0,T.TH)(),k=(0,o.useState)([]),H=(0,c.Z)(k,2),F=H[0],R=H[1],V=(0,o.useState)(!0),D=(0,c.Z)(V,2),L=D[0],J=D[1],K=(0,o.useState)(!1),q=(0,c.Z)(K,2),G=q[0],W=q[1],Q=(0,o.useState)(!1),U=(0,c.Z)(Q,2),X=U[0],$=U[1],ee=(0,o.useState)(!1),ne=(0,c.Z)(ee,2),te=ne[0],ae=ne[1],re=(0,o.useState)(!1),ie=(0,c.Z)(re,2),ce=ie[0],oe=ie[1],le=(0,o.useState)(!1),se=(0,c.Z)(le,2),ue=se[0],de=se[1],fe=(0,o.useState)(!1),me=(0,c.Z)(fe,2),he=me[0],pe=me[1],Ze=(0,o.useState)(!1),ve=(0,c.Z)(Ze,2),xe=ve[0],je=ve[1],ge=(0,o.useState)(),ye=(0,c.Z)(ge,2),be=ye[0],Se=ye[1],ke=(0,o.useState)(),_e=(0,c.Z)(ke,2),we=_e[0],Ce=_e[1],Ne=(0,o.useState)([]),Oe=(0,c.Z)(Ne,2),Ie=Oe[0],Pe=Oe[1],Te=(0,o.useState)({startTime:_()().subtract(1,"d").startOf("day").format("YYYY-MM-DD HH:mm:ss"),endTime:_()().subtract(1,"d").endOf("day").format("YYYY-MM-DD HH:mm:ss")}),Ee=(0,c.Z)(Te,2),Me=(Ee[0],Ee[1],{current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:[10,20,50,100,500],showTotal:function(e){return"\u5171".concat(e,"\u6761")}}),ze=(0,o.useState)(Me),He=(0,c.Z)(ze,2),Fe=He[0],Re=He[1],Ve=(0,o.useState)([]),De=(0,c.Z)(Ve,2),Le=De[0],Je=De[1],Ke=(0,o.useState)([]),Ye=(0,c.Z)(Ke,2),qe=Ye[0],Be=Ye[1],Ae=(0,o.useState)([]),Ge=(0,c.Z)(Ae,2),We=Ge[0],Qe=Ge[1],Ue=(0,o.useRef)(We),Xe=function(e){Ue.current=e,Qe(e)},$e=(0,o.useState)([]),en=(0,c.Z)($e,2),nn=en[0],tn=en[1],an=(0,o.useState)([]),rn=(0,c.Z)(an,2),cn=rn[0],on=rn[1],ln=(0,o.useState)([]),sn=(0,c.Z)(ln,2),un=sn[0],dn=sn[1],fn=(0,o.useState)([]),mn=(0,c.Z)(fn,2),hn=mn[0],pn=mn[1],Zn=(0,o.useState)({}),vn=(0,c.Z)(Zn,2),xn=vn[0],jn=vn[1],gn=(0,o.useState)({}),yn=(0,c.Z)(gn,2),bn=yn[0],Sn=yn[1],kn=(0,o.useRef)(bn),_n=(0,o.useState)([]),wn=(0,c.Z)(_n,2),Cn=wn[0],Nn=wn[1],On=(0,o.useState)(1e3),In=(0,c.Z)(On,2),Pn=In[0],Tn=In[1],En=(0,o.useState)([]),Mn=(0,c.Z)(En,2),zn=Mn[0],Hn=Mn[1],Fn=(0,o.useState)({}),Rn=(0,c.Z)(Fn,2),Vn=Rn[0],Dn=Rn[1],Ln=(0,o.useState)(),Jn=(0,c.Z)(Ln,2),Kn=Jn[0],Yn=Jn[1],qn=(0,o.useState)(),Bn=(0,c.Z)(qn,2),An=Bn[0],Gn=Bn[1],Wn=(0,o.useRef)(An),Qn=(0,o.useState)(!1),Un=(0,c.Z)(Qn,2),Xn=Un[0],$n=Un[1],et=(0,o.useState)([]),nt=(0,c.Z)(et,2),tt=nt[0],at=nt[1],rt=(0,o.useState)([]),it=(0,c.Z)(rt,2),ct=it[0],ot=it[1],lt=(0,o.useState)(),st=(0,c.Z)(lt,2),ut=st[0],dt=st[1],ft=(0,o.useState)(""),mt=(0,c.Z)(ft,2),ht=mt[0],pt=mt[1],Zt=(0,o.useState)(""),vt=(0,c.Z)(Zt,2),xt=vt[0],jt=vt[1],gt=(0,o.useState)(""),yt=(0,c.Z)(gt,2),bt=yt[0],St=yt[1],kt={pageConf:Me,params:[],paramsMap:Vn,sorter:void 0};(0,o.useEffect)((function(){St((0,E.W9)())}),[]),(0,o.useEffect)((function(){var e=encodeURIComponent(t.pathname);(0,z.se)(e).then((function(e){var n=e.data,t=n.title,a=n.content,r=n.hit;Se(t),Ce(a),je(r)})).catch((function(e){console.log(e)}))}),[]),(0,o.useEffect)((function(){var o=(0,E.jS)("targetId"),h=o?"/dimension_remote_table_modelview/".concat(o,"/api/"):null===e||void 0===e?void 0:e.url;(0,z.BQ)(h).then((function(o){var h=o.data,p=h.list_columns,Z=h.label_columns,v=h.filters,x=h.add_columns,j=h.edit_columns,g=h.permissions,y=h.description_columns,b=h.add_fieldsets,S=h.edit_fieldsets,k=h.help_url,_=h.order_columns,N=h.action,O=h.route_base,I=h.column_related,P=h.primary_key,T=h.label_title,M=h.cols_width,H=h.import_data,F=(null===e||void 0===e?void 0:e.related)||g.includes("can_show")||g.includes("can_edit")||g.includes("can_delete"),R=localStorage.getItem("tablebox_".concat(t.pathname)),V=JSON.parse(R||"[]").reduce((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.dataIndex,n.width))}),{}),D=Object.entries(I||{}).reduce((function(e,n){var t=(0,c.Z)(n,2),o=(t[0],t[1]);return[].concat((0,a.Z)(e),[{dep:o.src_columns,effect:o.des_columns.join(""),effectOption:o.related.reduce((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},(0,A.a)(n.src_value),n.des_value.map((function(e){return{label:e,value:e}}))))}),{})}])}),[]),L=p.map((function(e){return{title:Z[e]||e,dataIndex:e,key:e,sorter:_.includes(e)?function(n,t){return n[e]-t[e]}:void 0,render:function(n,t){var r;if(void 0===n||""===n)return"-";if(M[e]&&-1!==(null===(r=M[e].type)||void 0===r?void 0:r.indexOf("ellip")))return(0,Y.jsx)(l.Z,{title:(0,Y.jsx)("span",{className:"tips-content",dangerouslySetInnerHTML:{__html:n}}),placement:"topLeft",children:(0,Y.jsx)("div",{className:M[e].type,dangerouslySetInnerHTML:{__html:n}})});if("[object Object]"===Object.prototype.toString.call(n)){var i=Object.entries(n).reduce((function(e,n){var t=(0,c.Z)(n,2),r=t[0],i=t[1];return[].concat((0,a.Z)(e),[{label:r,value:i}])}),[]);return i.length?(0,Y.jsx)("div",{style:{overflow:"auto",maxHeight:100},children:i.map((function(e,n){return(0,Y.jsxs)("div",{children:[Z[e.label]||e.label,":",e.value]},"table_itemvalue_".concat(n))}))}):"-"}return(0,Y.jsx)("div",{style:{overflow:"auto",maxHeight:100},dangerouslySetInnerHTML:{__html:n}})},width:V[e]||M[e]&&M[e].width||100}})),J=Object.entries(N||{}).reduce((function(e,n){var t=(0,c.Z)(n,2),r=(t[0],t[1]);return[].concat((0,a.Z)(e),[(0,i.Z)({},r)])}),[]),K=J.filter((function(e){return!!e.multiple})),q=J.filter((function(e){return!!e.single})),B=function e(n){return n.map((function(n,t){var a=n["ui-type"]||"input";"select2"===a&&(a="select");var r=n.label||Z[n.name],i=(n.validators||[]).map((function(e){switch(e.type){case"DataRequired":return{required:!0,message:"\u8bf7\u8f93\u5165".concat(r)};case"Regexp":return{pattern:new RegExp("".concat(e.regex)),message:"\u8bf7\u6309\u6b63\u786e\u7684\u89c4\u5219\u8f93\u5165"};case"Length":return{min:e.min,max:e.max,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u957f\u5ea6"};default:return}})).filter((function(e){return!!e})),c=e(n.info||[]);return{label:r,type:a,rules:i,list:c,name:n.name,disable:n.disable,description:n.description||y[n.name]||void 0,required:n.required,defaultValue:""===n.default?void 0:n.default,multiple:n["ui-type"]&&"select2"===n["ui-type"],options:(n.values||[]).map((function(e){return{label:e.value,value:e.id}}))}}))},G={title:"\u64cd\u4f5c",width:80,dataIndex:"handle",key:"handle",align:"right",fixed:"right",render:function(a,r){var c;return(0,Y.jsx)(s.Z,{size:"middle",children:F?(0,Y.jsx)(u.Z,{overlay:(0,Y.jsxs)(d.Z,{children:[g.includes("can_show")?(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("div",{className:"link",onClick:function(){pe(!0),wt(r[P])},children:"\u8be6\u60c5"})}):null,g.includes("can_edit")?(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("div",{className:"link",onClick:function(){oe(!0),(0,z.BQ)(O,r[P]).then((function(e){var n=e.data.edit_columns,t=B(n),a=S.map((function(e){var n=e.fields.map((function(e){return U[e]})).filter((function(e){return!!e}));return{group:e.group,expanded:e.expanded,config:B(n)}}));console.log(t),on(t),pn(a),wt(r[P])})).catch((function(){f.ZP.warn("\u7528\u6237\u6ca1\u6709\u4fee\u6539\u6743\u9650")}))},children:"\u4fee\u6539"})}):null,g.includes("can_delete")?(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("div",{className:"c-fail cp",onClick:function(){m.Z.confirm({title:"\u5220\u9664",icon:(0,Y.jsx)(w.Z,{}),content:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4\u5220\u9664",cancelText:"\u53d6\u6d88",okButtonProps:{danger:!0},onOk:function(){return new Promise((function(e,n){(0,z.aM)("".concat(O).concat(r[P])).then((function(n){e("")})).catch((function(e){n()}))})).then((function(e){f.ZP.success("\u5220\u9664\u6210\u529f"),console.log(Ue.current),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Fe,params:Ue.current,paramsMap:v}))})).catch((function(){f.ZP.error("\u5220\u9664\u5931\u8d25")}))},onCancel:function(){}})},children:"\u5220\u9664"})}):null,null===e||void 0===e||null===(c=e.related)||void 0===c?void 0:c.map((function(e,a){return(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("div",{className:"link",onClick:function(){n("".concat(t.pathname,"/").concat(e.name,"?id=").concat(r[P]))},children:e.title})},"moreAction_".concat(a))})),!!q.length&&q.map((function(e,n){return(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("div",{className:"link",onClick:function(){m.Z.confirm({title:e.confirmation,icon:(0,Y.jsx)(w.Z,{}),content:"",okText:"\u786e\u8ba4".concat(e.confirmation),cancelText:"\u53d6\u6d88",onOk:function(){return new Promise((function(n,t){(0,z.y5)("".concat(O,"action/").concat(e.name,"/").concat(r[P])).then((function(e){n("")})).catch((function(e){t()}))})).then((function(e){f.ZP.success("\u64cd\u4f5c\u6210\u529f"),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Fe,params:Ue.current,paramsMap:v}))})).catch((function(){f.ZP.error("\u64cd\u4f5c\u5931\u8d25")}))},onCancel:function(){}})},children:e.text})},"table_action_".concat(n))}))]}),children:(0,Y.jsxs)("div",{className:"link",children:["\u66f4\u591a",(0,Y.jsx)(C.Z,{})]})}):null})}},W=(0,a.Z)(L);F&&W.push(G);var Q=x.reduce((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.name,n))}),{}),U=j.reduce((function(e,n){return(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.name,n))}),{}),X=B(x),$=b.map((function(e){var n=e.fields.map((function(e){return Q[e]})).filter((function(e){return!!e}));return{group:e.group,expanded:e.expanded,config:B(n)}})),ee=Object.entries(v).reduce((function(e,n){var t=(0,c.Z)(n,2),r=t[0],i=t[1];return[].concat((0,a.Z)(e),[{name:r,type:i["ui-type"]||"input",title:Z[r],oprList:i.filter.map((function(e){return e.operator})),defalutValue:""===i.default?void 0:i.default,option:i.values?i.values.map((function(e){return{label:e.value,value:e.id}})):void 0}])}),[]),ne=Object.entries(v).reduce((function(e,n){var t=(0,c.Z)(n,2),r=t[0],i=t[1];return[].concat((0,a.Z)(e),[{key:r,value:i.default}])}),[]).filter((function(e){return e.value})),te=JSON.parse(localStorage.getItem("filter_".concat(t.pathname).concat(t.search))||"[]"),ae=void 0;if((0,E.jS)("filter"))try{ae=JSON.parse((0,E.jS)("filter")||"[]")}catch(le){f.ZP.error("filter\u89e3\u6790\u5f02\u5e38")}var re,ie=ae||te;ie&&ie.length&&(ne=ie),$n(H),jt(T),pt(P),at(D),ot(K),re=O,Wn.current=re,Gn(re),jn(U),Dn(v),Je(W),Be(ee),tn(X),dn($),function(e){kn.current=e,Sn(e)}(Z),Hn(g);var ce=R?W.reduce((function(e,n){return e+n.width||100}),0)+80:100*W.length+80+80;Tn(ce),Yn(k),Xe(ne),_t({pageConf:Me,params:ne,paramsMap:v,sorter:void 0})}))}),[]);var _t=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageConf:Me,params:We,paramsMap:Vn,sorter:void 0},t=n.pageConf,r=n.params,c=n.paramsMap,o=n.sorter;J(!0);var l=void 0,s=(0,E.jS)("id");l=JSON.stringify((0,i.Z)({str_related:1,filters:[s?{col:null===e||void 0===e?void 0:e.model_name,opr:"rel_o_m",value:+s}:void 0].concat((0,a.Z)(r.filter((function(e){return void 0!==e.value})).map((function(e){console.log(c[e.key]);var n="";if(!isNaN(+e.value)&&c[e.key]&&"Related"!==c[e.key].type&&"QuerySelect"!==c[e.key].type)n="eq";else for(var t=["ct","lt","eq","rel_o_m"],a=c[e.key].filter.map((function(e){return e.operator}))||[],r=0;r<t.length;r++){var i=t[r];if(a.includes(i)){n=i;break}}return{col:e.key,opr:n,value:e.value}})))).filter((function(e){return!!e})),page:(t.current||1)-1,page_size:t.pageSize||10},o)),(0,z.jm)(Wn.current,{form_data:l}).then((function(e){var n=e.data.result,a=n.count,r=n.data;R(r),Pe([]),Re((0,i.Z)((0,i.Z)((0,i.Z)({},Me),t),{},{total:a})),dt(o)})).catch((function(e){console.log(e)})).finally((function(){return J(!1)}))},wt=function(e){de(!0),Nn([]),(0,z.kI)("".concat(Wn.current).concat(e)).then((function(e){var n=e.data.result,t=[],a=function(e){return"[object Object]"===Object.prototype.toString.call(e)?e.last_name:e};Object.keys(n).forEach((function(e){t.push({label:kn.current[e]||e,value:a(n[e]),key:e})})),Nn(t)})).catch((function(e){})).finally((function(){de(!1)}))},Ct={name:"csv_file",maxCount:1,action:"".concat(An,"upload/"),headers:{authorization:"authorization-text"},beforeUpload:function(e){var n=-1!==e.name.indexOf(".csv");return n||f.ZP.error("".concat(e.name," \u5e76\u4e0d\u662fcsv\u6587\u4ef6")),n||h.Z.LIST_IGNORE},onChange:function(e){"done"===e.file.status?p.Z.success({message:"\u5bfc\u5165\u6210\u529f",description:JSON.stringify(e.file.response)}):"error"===e.file.status&&p.Z.error({message:"\u5bfc\u5165\u5931\u8d25",description:JSON.stringify(e.file.response)})}};return(0,Y.jsxs)("div",{className:"fade-in",children:[(0,Y.jsx)(Z.Z,{contentWrapperStyle:{width:"auto"},title:be,placement:"right",onClose:function(){je(!1)},visible:xe,children:(0,Y.jsx)("div",{dangerouslySetInnerHTML:{__html:we||""}})}),(0,Y.jsx)(M.Z,{title:"\u6dfb\u52a0".concat(xt),width:800,loading:G,visible:X,onCancel:function(){$(!1)},onCreate:function(e){for(var n in W(!0),e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=e[n];if(Array.isArray(t)){if(t[0]&&"[object Object]"===Object.prototype.toString.call(t[0]))continue;e[n]=e[n].join(",")}}(0,z.P9)(Wn.current,e).then((function(e){f.ZP.success("\u6dfb\u52a0".concat(xt,"\u6210\u529f")),$(!1),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Fe,params:We,sorter:ut,paramsMap:Vn}))})).catch((function(e){f.ZP.error("\u6dfb\u52a0".concat(xt,"\u5931\u8d25"))})).finally((function(){W(!1)}))},children:function(e,n){return(0,Y.jsx)(A.Z,{form:e,formChangeRes:n,linkageConfig:tt,config:nn,configGroup:un})}}),(0,Y.jsx)(M.Z,{title:"\u4fee\u6539".concat(xt),width:800,formData:Cn.reduce((function(e,n){if("select"===(xn[n.key]||{})["ui-type"]){var t=n.value,a=(xn[n.key]||{}).values||[],c=a.map((function(e){return e.value})).indexOf(n.value);return~c&&(t=a[c].id),(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.key,t))}return"select2"===(xn[n.key]||{})["ui-type"]?(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.key,(n.value||"").split(","))):(0,i.Z)((0,i.Z)({},e),{},(0,r.Z)({},n.key,n.value))}),{}),loading:te||ue,visible:ce,onCancel:function(){oe(!1)},onCreate:function(e){for(var n in ae(!0),Nn([]),e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=e[n];if(Array.isArray(t)){if(t[0]&&"[object Object]"===Object.prototype.toString.call(t[0]))continue;e[n]=e[n].join(",")}}(0,z.a1)("".concat(Wn.current).concat(e[ht]),e).then((function(e){f.ZP.success("\u66f4\u65b0".concat(xt,"\u6210\u529f")),oe(!1),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Fe,params:We,sorter:ut,paramsMap:Vn}))})).catch((function(e){f.ZP.error("\u66f4\u65b0".concat(xt,"\u5931\u8d25"))})).finally((function(){ae(!1)}))},children:function(e){return(0,Y.jsx)(A.Z,{form:e,primaryKey:ht,config:cn,linkageConfig:tt,configGroup:hn})}}),(0,Y.jsx)(m.Z,{title:"".concat(xt,"\u8be6\u60c5"),visible:he,footer:null,width:800,destroyOnClose:!0,onCancel:function(){pe(!1)},children:(0,Y.jsx)(v.Z,{spinning:ue,children:(0,Y.jsx)("div",{className:"pb32",style:{minHeight:300},children:Cn.map((function(e,n){return(0,Y.jsxs)(x.Z,{className:"mb16",children:[(0,Y.jsx)(j.Z,{span:6,children:(0,Y.jsx)("div",{className:"ta-r",children:(0,Y.jsxs)("strong",{children:[e.label,"\uff1a"]})})}),(0,Y.jsx)(j.Z,{span:18,children:(0,Y.jsx)("span",{dangerouslySetInnerHTML:{__html:e.value}})})]},"dataDetail_".concat(n))}))})})}),(0,Y.jsx)(b.Z,{title:(0,Y.jsxs)(Y.Fragment,{children:[null!==e&&void 0!==e&&e.isSubRoute||(0,E.jS)("targetId")?(0,Y.jsxs)(g.Z,{className:"mr16",onClick:function(){n("/data/metadata/metadata_dimension"),window.location.reload()},children:[(0,Y.jsx)(N.Z,{}),"\u8fd4\u56de"]}):null,(0,Y.jsx)("span",{children:xt})]}),breadcrumbs:((null===e||void 0===e?void 0:e.breadcrumbs)||[]).map((function(n,t){return(0,Y.jsxs)("span",{className:"c-hint-b fs12",children:["/",(0,Y.jsx)("span",{className:"plr2",children:n})]},"templateTitle_".concat(null===e||void 0===e?void 0:e.name,"_").concat(t))})),children:Kn?(0,Y.jsxs)("div",{className:"link",children:[(0,Y.jsx)("span",{className:"pr4",onClick:function(){window.open(Kn,"blank")},children:"\u5e2e\u52a9\u94fe\u63a5"}),(0,Y.jsx)(O.Z,{})]}):null}),(0,Y.jsxs)(y.VY,{className:"appmgmt-content bg-title",children:[!!qe.length&&(0,Y.jsx)(B,{values:We,params:qe,onChange:function(e){localStorage.setItem("filter_".concat(t.pathname).concat(t.search),JSON.stringify(e)),Xe(e),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Me,params:e,sorter:ut,paramsMap:Vn}))}}),(0,Y.jsx)("div",{className:"m16",children:(0,Y.jsx)(S.Z,{tableKey:"tablebox_".concat(t.pathname),titleNode:(0,Y.jsxs)(j.Z,{className:"tablebox-title",children:[xt,"\u5217\u8868"]}),buttonNode:(0,Y.jsxs)("div",{className:"d-f ac",children:[zn.includes("can_add")?(0,Y.jsxs)(g.Z,{className:"mr16",type:"primary",onClick:function(){return $(!0)},children:["\u6dfb\u52a0",xt,(0,Y.jsx)(I.Z,{})]}):null,(0,Y.jsx)("div",{children:(0,Y.jsx)(u.Z,{overlay:(0,Y.jsx)(d.Z,{children:ct.map((function(e,n){return(0,Y.jsx)(d.Z.Item,{children:(0,Y.jsx)("span",{className:"link",onClick:function(){return function(e){Ie.length?m.Z.confirm({title:e.confirmation,icon:(0,Y.jsx)(w.Z,{}),content:"",okText:"\u786e\u8ba4".concat(e.confirmation),cancelText:"\u53d6\u6d88",onOk:function(){return new Promise((function(n,t){(0,z.Eb)("".concat(Wn.current,"multi_action/").concat(e.name),{ids:Ie.map((function(e){return JSON.parse(e||"{}")[ht]}))}).then((function(e){n("")})).catch((function(e){t()}))})).then((function(e){f.ZP.success("\u64cd\u4f5c\u6210\u529f"),_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:Fe,params:We,sorter:ut,paramsMap:Vn}))})).catch((function(){f.ZP.error("\u64cd\u4f5c\u5931\u8d25")}))},onCancel:function(){}}):f.ZP.warn("\u8bf7\u5148\u9009\u62e9")}(e)},children:"\u6279\u91cf".concat(e.text)})},"table_muliple_".concat(n))}))}),children:(0,Y.jsxs)(g.Z,{children:["\u6279\u91cf\u64cd\u4f5c ",(0,Y.jsx)(C.Z,{})]})})}),Xn?(0,Y.jsx)("div",{className:"d-f ml16",children:(0,Y.jsx)(l.Z,{title:(0,Y.jsx)("span",{className:"tips-content",children:"\u6ce8\u610f\uff1acsv\u9017\u53f7\u5206\u9694\uff0c\u7b2c\u4e00\u884c\u4e3a\u5217\u7684\u82f1\u6587\u540d"}),placement:"topLeft",children:(0,Y.jsx)(h.Z,(0,i.Z)((0,i.Z)({},Ct),{},{children:(0,Y.jsx)(g.Z,{className:"",icon:(0,Y.jsx)(P.Z,{}),children:"\u5bfc\u5165\u6570\u636e"})}))})}):null]}),rowKey:function(e){return JSON.stringify(e)},columns:Le,loading:L,pagination:Fe,dataSource:F,onChange:function(e,n,t){var a=t.order?{order_column:t.columnKey,order_direction:"ascend"===t.order?"asc":"desc"}:void 0;_t((0,i.Z)((0,i.Z)({},kt),{},{pageConf:e,params:We,paramsMap:Vn,sorter:a}))},rowSelection:{type:"checkbox",fixed:"left",columnWidth:80,selectedRowKeys:Ie,onChange:function(e){Pe(e)}},scroll:{x:Pn,y:bt}})})]})]})}},602:function(e,n,t){e.exports=t.p+"static/media/emptyBg.15fdf5f39309784ac66e.png"}}]);
//# sourceMappingURL=81.d518af8a.chunk.js.map