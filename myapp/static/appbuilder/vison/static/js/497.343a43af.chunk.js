"use strict";(self.webpackChunkvite_ml_platform=self.webpackChunkvite_ml_platform||[]).push([[497],{60238:function(e,t,n){var a=n(67487),s="http://11.187.53.46:8080/api";t.Z={query_abtests:function(e){return a.Z.post({url:"".concat(s,"/query_abtests"),data:e})},query_edge_factorys:function(e){return a.Z.post({url:"".concat(s,"/query_edge_factorys"),data:e})},delete_edge_factory:function(e){return a.Z.post({url:"".concat(s,"/delete_edge_factory"),data:e})},query_structs:function(e){return a.Z.post({url:"".concat(s,"/query_structs"),data:e})},delete_struct:function(e){return a.Z.post({url:"".concat(s,"/delete_struct"),data:e})},query_associated_nodes:function(e){return a.Z.post({url:"".concat(s,"/query_associated_nodes"),data:e})},mod_struct:function(e){return a.Z.post({url:"".concat(s,"/mod_struct"),data:e})},add_struct:function(e){return a.Z.post({url:"".concat(s,"/add_struct"),data:e})},query_scenes:function(e){return a.Z.post({url:"".concat(s,"/query_scenes"),data:e})},query_associated_graphs:function(e){return a.Z.post({url:"".concat(s,"/query_associated_graphs"),data:e})},add_scene:function(e){return a.Z.post({url:"".concat(s,"/add_scene"),data:e})},mod_scene:function(e){return a.Z.post({url:"".concat(s,"/mod_scene"),data:e})},query_graph_templates:function(e){return a.Z.post({url:"".concat(s,"/query_graph_templates"),data:e})},query_components:function(e){return a.Z.post({url:"".concat(s,"/query_components"),data:e})},delete_component:function(e){return a.Z.post({url:"".concat(s,"/delete_component"),data:e})},query_component_historys:function(e){return a.Z.post({url:"".concat(s,"/query_component_historys"),data:e})},get_scene_names:function(e){return a.Z.post({url:"".concat(s,"/get_scene_names"),data:e})},get_scene_available_graphs:function(e){return a.Z.post({url:"".concat(s,"/get_scene_available_graphs"),data:e})},mod_abtest:function(e){return a.Z.post({url:"".concat(s,"/mod_abtest"),data:e})},add_abtest:function(e){return a.Z.post({url:"".concat(s,"/add_abtest"),data:e})},query_graphs:function(e){return a.Z.post({url:"".concat(s,"/query_graphs"),data:e})},get_graph_template_names:function(e){return a.Z.post({url:"".concat(s,"/get_graph_template_names"),data:e})},batch_query_components:function(e){return a.Z.post({url:"".concat(s,"/batch_query_components"),data:e})},query_graph_historys:function(e){return a.Z.post({url:"".concat(s,"/query_graph_historys"),data:e})},query_template_available_node_factorys:function(e){return a.Z.post({url:"".concat(s,"/query_template_available_node_factorys"),data:e})},get_edge_factory_names:function(e){return a.Z.post({url:"".concat(s,"/get_edge_factory_names"),data:e})},get_node_factory_names:function(e){return a.Z.post({url:"".concat(s,"/get_node_factory_names"),data:e})},query_node_factorys:function(e){return a.Z.post({url:"".concat(s,"/query_node_factorys"),data:e})},mod_graph:function(e){return a.Z.post({url:"".concat(s,"/mod_graph"),data:e})},add_graph:function(e){return a.Z.post({url:"".concat(s,"/add_graph"),data:e})},get_config_prototype:function(e){return a.Z.post({url:"".concat(s,"/get_config_prototype"),data:e})},rollback_graph:function(e){return a.Z.post({url:"".concat(s,"/rollback_graph"),data:e})}}},17097:function(e,t,n){n.d(t,{Q:function(){return a},a:function(){return s}});var a={0:"\u6709\u6548","-1":"\u5931\u6548",1:"\u521b\u5efa\u6210\u529f",2:"\u6d4b\u8bd5\u53d1\u5e03",3:"\u6b63\u5f0f\u53d1\u5e03",4:"\u516c\u6709",5:"\u79c1\u6709"},s={0:"green","-1":"#F56C6C",1:"#67C23A",2:"green",3:"#E6A23C",4:"#409EFF",5:"#909399"}},99154:function(e,t,n){n.d(t,{Z:function(){return f}});var a=n(72791),s=n(13295),r=n(58646),o=n(66106),c=n(30914),i=n(20135),l=n(58105),d=n(73231),u=n(87309),m=n(80184),p=s.Z.RangePicker;function f(e){var t=(0,a.useRef)(null);(0,a.useEffect)((function(){console.log("\u89e6\u53d1\u4e86",t.current.setFieldsValue(e.form))}),[]);return(0,m.jsx)("div",{children:(0,m.jsx)(r.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(t){e.queryList(t)},onFinishFailed:function(){console.log("\u5931\u8d25")},autoComplete:"off",ref:t,children:(0,m.jsxs)(o.Z,{children:[e.formRolue.map((function(e){switch(e.type){case"input":return(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{label:e.label,name:e.name,children:(0,m.jsx)(i.Z,{})},e.name)});case"select":return(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{label:e.label,name:e.name,children:(0,m.jsx)(l.Z,{children:e.options?e.options.map((function(e){return(0,m.jsx)(l.Z.Option,{value:e.value,children:e.label},e.value)})):null})},e.name)});case"picker":return(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{label:e.label,name:e.name,children:(0,m.jsx)(s.Z,{style:{width:"100%"}})},e.name)});case"radio":return(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{label:e.label,name:e.name,children:(0,m.jsxs)(d.ZP.Group,{children:[(0,m.jsx)(d.ZP,{value:1,children:"A"}),e.options?e.options.map((function(e){return(0,m.jsx)(d.ZP,{value:e.value,children:e.label},e.value)})):null]})},e.name)});case"rangePicker":return(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{label:e.label,name:e.name,children:(0,m.jsx)(p,{})},e.name)})}})),(0,m.jsx)(c.Z,{span:6,children:(0,m.jsx)(r.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,m.jsx)(u.Z,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"})})})]})})})}},87497:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var a=n(50678),s=n(72791),r=n(23695),o=n(47528),c=n(83099),i=n(28183),l=n(64564),d=n(87309),u=n(618),m=n(48757),p=n(99154),f=n(58105),_=n(20135),Z=n(58646),h=n(66106),x=n(30914),y=n(79286),g=n(60238),j=n(80184),v=(f.Z.Option,_.Z.TextArea);function b(e){console.log(e.showEdit);var t=Z.Z.useForm(),n=(0,a.Z)(t,1)[0];(0,s.useEffect)((function(){n.resetFields(),n.setFieldsValue(e.form)}));return(0,j.jsxs)(Z.Z,{form:n,name:"dynamic_form_nest_item",className:"structure-form",labelAlign:"left",labelCol:{span:4},onFinish:function(t){var n={};t.config&&t.config.forEach((function(e){n[e.name]={type:e.type,tag:e.tag,json:e.json,des:e.des}}));var a={struct_name:t.struct_name,des:t.des,status:1,admin:t.admin,config:JSON.stringify(n)};e.form.version?(a.version=e.form.version+1,g.Z.mod_struct({opr:"mod_struct",data:a}).then((function(t){console.log(t),0===t.status?(r.ZP.success(t.message),e.resFied()):r.ZP.error(t.message)}))):g.Z.add_struct({opr:"add_struct",data:a}).then((function(t){0===t.status?(r.ZP.success(t.message),e.resFied()):r.ZP.error(t.message)}))},autoComplete:"off",children:[(0,j.jsxs)(h.Z,{gutter:10,children:[(0,j.jsx)(x.Z,{span:13,children:(0,j.jsx)(Z.Z.Item,{name:"struct_name",label:"\u7ed3\u6784\u4f53\u540d",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7ed3\u6784\u540d"}],children:(0,j.jsx)(_.Z,{disabled:!e.isadd})})}),(0,j.jsxs)(x.Z,{span:24,children:[(0,j.jsxs)(h.Z,{style:{width:"100%"},children:[(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)("div",{className:"config-title",children:"\u5b57\u6bb5\u540d"})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)("div",{className:"config-title",children:"\u5b57\u6bb5\u7c7b\u578b"})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)("div",{className:"config-title",children:"\u5b57\u6bb5Tag"})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)("div",{className:"config-title",children:"\u5b57\u6bb5\u63cf\u8ff0"})})]}),(0,j.jsx)(Z.Z.List,{name:"config",children:function(t,n){var a=n.add,s=n.remove;return(0,j.jsxs)(j.Fragment,{children:[t.map((function(t){return(0,j.jsxs)(h.Z,{style:{width:"100%"},children:[(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)(Z.Z.Item,{className:"config-item",name:[t.name,"name"],rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d"}],children:(0,j.jsx)(_.Z,{disabled:!e.isadd,placeholder:"\u8bf7\u8f93\u5165"})})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)(Z.Z.Item,{className:"config-item",name:[t.name,"type"],rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u7c7b\u578b"}],children:(0,j.jsxs)(f.Z,{placeholder:"\u8bf7\u9009\u62e9",disabled:!e.isadd,children:[(0,j.jsx)(f.Z.Option,{value:"string",children:"string"},"0"),(0,j.jsx)(f.Z.Option,{value:"int",children:"int"},"1"),(0,j.jsx)(f.Z.Option,{value:"number",children:"number"},"2")]})})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)(Z.Z.Item,{className:"config-item",name:[t.name,"tag"],children:(0,j.jsx)(_.Z,{disabled:!e.isadd,placeholder:"\u8bf7\u8f93\u5165"})})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)(Z.Z.Item,{className:"config-item",name:[t.name,"des"],children:(0,j.jsx)(_.Z,{disabled:!e.isadd,placeholder:"\u8bf7\u8f93\u5165"})})}),(0,j.jsx)(x.Z,{span:4,children:(0,j.jsx)(Z.Z.Item,{className:"config-item",children:(0,j.jsx)(d.Z,{disabled:!e.isadd,style:{marginLeft:"10px"},onClick:function(){s(t.name)},children:"\u5220\u9664"})})})]},t.key)})),(0,j.jsx)(Z.Z.Item,{children:(0,j.jsx)(d.Z,{disabled:!e.isadd,style:{margin:"10px 0px",width:"66.7%"},type:"dashed",onClick:function(){return a()},block:!0,icon:(0,j.jsx)(y.Z,{}),children:"\u589e\u52a0"})})]})}})]}),(0,j.jsx)(x.Z,{span:13,children:(0,j.jsx)(Z.Z.Item,{name:"des",label:"\u63cf\u8ff0",children:(0,j.jsx)(v,{rows:4,disabled:!e.isadd})})}),(0,j.jsx)(x.Z,{span:13,children:(0,j.jsx)(Z.Z.Item,{name:"admin",label:"\u8d1f\u8d23\u4eba",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d1f\u8d23\u4eba"}],children:(0,j.jsx)(_.Z,{disabled:!e.isadd})})})]}),e.isadd?(0,j.jsx)(Z.Z.Item,{children:(0,j.jsx)(d.Z,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})}):null]})}var k={struct_name:"",status:0,admin:"",time:""},q=[{type:"input",name:"struct_name",label:"\u7ed3\u6784\u4f53\u540d"},{type:"select",name:"status",label:"\u72b6\u6001",options:[{value:-1,label:"\u5931\u6548"},{value:0,label:"\u6709\u6548"},{value:1,label:"\u521b\u5efa\u6210\u529f"},{value:2,label:"\u6d4b\u8bd5\u53d1\u5e03"},{value:3,label:"\u6b63\u5f0f\u53d1\u5e03"},{value:4,label:"\u516c\u6709"},{value:5,label:"\u79c1\u6709"}]},{type:"input",name:"admin",label:"\u8d1f\u8d23\u4eba"},{type:"rangePicker",name:"time",label:"\u66f4\u65b0\u65f6\u95f4"}],C=n(17097);function I(){var e=(0,s.useState)(!1),t=(0,a.Z)(e,2),n=t[0],f=t[1],_=(0,s.useState)([]),Z=(0,a.Z)(_,2),h=Z[0],x=Z[1],y=(0,s.useState)([]),v=(0,a.Z)(y,2),I=v[0],P=v[1],T=(0,s.useState)({}),w=(0,a.Z)(T,2),N=w[0],E=w[1],O=(0,s.useState)(!1),F=(0,a.Z)(O,2),S=F[0],V=F[1],R=(0,s.useState)(!1),A=(0,a.Z)(R,2),L=A[0],Q=A[1],z=[{title:"#",render:function(e,t,n){return(0,j.jsx)("a",{children:n+1+""})}},{title:"\u7c7b\u578b",dataIndex:"type",key:"type"},{title:"\u7248\u672c",dataIndex:"version",key:"version"},{title:"\u5de5\u5382\u540d",dataIndex:"factory_name",key:"factory_name"},{title:"\u540d\u79f0",dataIndex:"name",key:'"name'},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){return(0,j.jsx)(o.Z,{color:C.a[e]?C.a[e]:"",children:C.Q[e]?C.Q[e]:""})}},{title:"\u8d1f\u8d23\u4eba",dataIndex:"admin",key:"admin"},{title:"\u63cf\u8ff0",dataIndex:"des",key:"des"},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updated_time",key:"updated_time"}],D=[{title:"#",dataIndex:"bussiness_id",key:"bussiness_id",render:function(e,t,n){return(0,j.jsx)("a",{children:n+1+""})}},{title:"\u7ed3\u6784\u4f53\u540d",fType:"input",dataIndex:"struct_name",key:"struct_name"},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){return(0,j.jsx)(o.Z,{color:C.a[e]?C.a[e]:"",children:C.Q[e]?C.Q[e]:""})}},{title:"\u8d1f\u8d23\u4eba",fType:"input",dataIndex:"admin",key:"admin"},{title:"\u63cf\u8ff0",fType:"textArea",dataIndex:'"des',key:'"des'},{title:"\u66f4\u65b0\u65f6\u95f4",fType:"input",dataIndex:"updated_time",key:"updated_time"},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return(0,j.jsxs)(c.Z,{size:"middle",children:[(0,j.jsx)("a",{onClick:function(){var e=[],n=JSON.parse(t.config);for(var a in console.log(n),n)e.push({name:a,type:n[a].type,tag:n[a].tag,json:n[a].json,des:n[a].des});var s={struct_name:t.struct_name,status:t.status,des:t.des,admin:t.admin,config:e};V(!1),E(s),f(!0)},children:"\u67e5\u770b"},"view"),(0,j.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),(0,j.jsx)("a",{onClick:function(){var e=[],n=JSON.parse(t.config);for(var a in console.log(n),n)e.push({name:a,type:n[a].type,tag:n[a].tag,json:n[a].json,des:n[a].des});var s={struct_name:t.struct_name,status:t.status,des:t.des,admin:t.admin,config:e,version:t.version};V(!0),E(s),f(!0)},children:"\u7f16\u8f91"},"edit"),(0,j.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),(0,j.jsx)(i.Z,{title:"\u662f\u5426\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onConfirm:function(){K(t)},children:(0,j.jsx)("a",{children:"\u5220\u9664"},"del")}),(0,j.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),t.associated_nodes&&t.associated_nodes.length?(0,j.jsxs)("a",{onClick:function(){!function(e){var t={opr:"query_associated_nodes",data:{associated_nodes:e.associated_nodes}};g.Z.query_associated_nodes(t).then((function(e){console.log(e),0===e.status?(P(e.data.results),Q(!0),r.ZP.success(e.message)):(x([]),r.ZP.error(e.message))}))}(t)},children:[" \u5173\u8054\u8282\u70b9 (",t.associated_nodes&&t.associated_nodes.length?t.associated_nodes.length:0," )"]},"node"):(0,j.jsx)("span",{style:{color:"#999"},children:"\u5173\u8054\u8282\u70b9"})]})}}],J=D.filter((function(e){return e.fType})).map((function(e){return{type:e.fType,name:e.dataIndex,label:e.title}})),B=function(e){var t=e.admin,n=e.struct_name,a=e.status,s=e.time,o={struct_name:n||"",admin:t||"",status:a||0,min_updated_time:s&&s[0]?new Date(s[0]).getTime():0,max_updated_time:s&&s[1]?new Date(s[1]).getTime():0};g.Z.query_structs({opr:"query_structs",data:o}).then((function(e){0===e.status?(x(e.data.results),r.ZP.success(e.message)):r.ZP.error(e.message)}))};(0,s.useEffect)((function(){B({})}),[]);var K=function(e){var t={opr:"delete_struct",data:{struct_name:e.struct_name}};g.Z.delete_struct(t).then((function(e){console.log(e),0===e.status?(r.ZP.success(e.message),B({})):r.ZP.error(e.message)}))};return(0,j.jsxs)("div",{style:{padding:"30px 40px"},children:[(0,j.jsxs)("div",{children:[(0,j.jsx)(l.Z,{title:"\u67e5\u8be2\u6761\u4ef6",children:(0,j.jsx)(p.Z,{formRolue:q,form:k,queryList:B})}),(0,j.jsx)(l.Z,{title:"\u67e5\u8be2\u7ed3\u679c",extra:(0,j.jsx)(d.Z,{type:"primary",onClick:function(){return V(!0),E({name:""}),void f(!0)},children:"\u65b0\u589e"}),style:{marginTop:"20px"},children:(0,j.jsx)(u.Z,{columns:D,dataSource:h},"struct_name")})]}),(0,j.jsx)(m.Z,{width:900,title:"",visible:n,onCancel:function(){f(!1)},footer:[(0,j.jsx)(d.Z,{onClick:function(){f(!1)},children:"\u5173\u95ed"},"back")],children:(0,j.jsx)(b,{formRolue:J,form:N,isadd:S,disableds:!0,resFied:function(){f(!1),B({})}})}),(0,j.jsx)(m.Z,{width:"60%",title:"\u5173\u8054\u8282\u70b9",visible:L,onCancel:function(){Q(!1)},footer:[(0,j.jsx)(d.Z,{onClick:function(){Q(!1)},children:"\u5173\u95ed"},"back")],children:(0,j.jsx)("div",{style:{width:"100%",overflowY:"auto"},children:(0,j.jsx)(u.Z,{columns:z,dataSource:I},"struct_name")})})]})}},28183:function(e,t,n){n.d(t,{Z:function(){return b}});var a=n(87462),s=n(29439),r=n(72791),o=n(81694),c=n.n(o),i=n(75179),l=n(10187),d=n(11354),u=n(64469),m=n(87309),p=n(6417),f=n(93486),_=n(70454),Z=n(24886),h=n(61113),x=n(29464),y=n(41783),g=void 0,j=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n},v=r.forwardRef((function(e,t){var n=r.useContext(Z.E_).getPrefixCls,o=(0,i.Z)(!1,{value:e.visible,defaultValue:e.defaultVisible}),l=(0,s.Z)(o,2),v=l[0],b=l[1],k=function(t,n){var a;b(t),null===(a=e.onVisibleChange)||void 0===a||a.call(e,t,n)},q=function(e){k(!1,e)},C=function(t){var n;return null===(n=e.onConfirm)||void 0===n?void 0:n.call(g,t)},I=function(t){var n;k(!1,t),null===(n=e.onCancel)||void 0===n||n.call(g,t)},P=e.prefixCls,T=e.placement,w=e.children,N=e.overlayClassName,E=j(e,["prefixCls","placement","children","overlayClassName"]),O=n("popover",P),F=n("popconfirm",P),S=c()(F,N),V=r.createElement(f.Z,{componentName:"Popconfirm",defaultLocale:_.Z.Popconfirm},(function(t){return function(t,s){var o,c=e.okButtonProps,i=e.cancelButtonProps,l=e.title,d=e.cancelText,u=e.okText,f=e.okType,_=e.icon;return r.createElement("div",{className:"".concat(t,"-inner-content")},r.createElement("div",{className:"".concat(t,"-message")},_,r.createElement("div",{className:"".concat(t,"-message-title")},(o=l)?"function"===typeof o?o():o:null)),r.createElement("div",{className:"".concat(t,"-buttons")},r.createElement(m.Z,(0,a.Z)({onClick:I,size:"small"},i),d||s.cancelText),r.createElement(y.Z,{buttonProps:(0,a.Z)((0,a.Z)({size:"small"},(0,p.n)(f)),c),actionFn:C,close:q,prefixCls:n("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},u||s.okText)))}(O,t)})),R=n();return r.createElement(u.Z,(0,a.Z)({},E,{prefixCls:O,placement:T,onVisibleChange:function(t){e.disabled||k(t)},visible:v,overlay:V,overlayClassName:S,ref:t,transitionName:(0,x.m)(R,"zoom-big",e.transitionName)}),(0,h.Tm)(w,{onKeyDown:function(e){var t,n;r.isValidElement(w)&&(null===(n=null===w||void 0===w?void 0:(t=w.props).onKeyDown)||void 0===n||n.call(t,e)),function(e){e.keyCode===d.Z.ESC&&v&&k(!1,e)}(e)}}))}));v.defaultProps={placement:"top",trigger:"click",okType:"primary",icon:r.createElement(l.Z,null),disabled:!1};var b=v}}]);